(window.webpackJsonpsandbox=window.webpackJsonpsandbox||[]).push([[0],{123:function(e,t){},214:function(e,t,n){e.exports=n(363)},310:function(e,t,n){},311:function(e,t,n){},335:function(e,t){},361:function(e,t,n){},362:function(e,t,n){},363:function(e,t,n){"use strict";n.r(t);var a=n(9),o=n.n(a),r=n(116),i=n.n(r),c=n(0),s=n(5),l=n(166),p=n.n(l),d=n(36),u=n.n(d);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(n,!0).forEach(function(t){Object(c.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var f=function(e,t){var n=new Date(t),a=new Date(e),o=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()),r=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate());return Math.floor((r-o)/864e5)},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e||{},n=t.startDate,a=t.endDate,o=t.minDate,r=t.maxDate;if(!n||!a||!o||!r)return null;var i=new Date(o),c=new Date(r),s=f(c,i),l=new Date(n),p=new Date(a),d=s-f(c,l),u=s-f(c,p),m=d||0,g=u||s;return{startDayIndex:m,endDayIndex:g,numberOfDays:s}},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.reduce(function(e,t){var n=t.key,a=t.default;return g({},e,Object(c.a)({},n,a))},{}),a=g({},n,{},t),o=a.startDate,r=a.endDate,i=a.trimEndDate,s=a.maxAbsoluteDate,l=o,p=r>s?s:r,d=i>s?s:i;return g({},a,{},!!l&&{startYear:u()(l).year(),startMonth:u()(l).month(),startDay:u()(l).dayOfYear()},{},!!r&&{endYear:u()(p).year(),endMonth:u()(p).month(),endDay:u()(p).dayOfYear()},{},!!i&&{trimEndYear:u()(d).year(),trimEndMonth:u()(d).month(),trimEndDay:u()(d).dayOfYear()},{},y(a))},h=n(172),v=n(2),w=n(1),O=n(7),C=n(4),j=n(8),P=n(167),D=n.n(P),E=n(59),x=n.n(E),k=n(39),S=n.n(k),M=n(98),z=n(368),I=n(171);n(309),n(310);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(n,!0).forEach(function(t){Object(c.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var T={zoom:2,lat:0,lng:0},Y=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(O.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).events={},n.state={viewport:L({},T,{},n.props.viewport),flying:!1,loaded:!1},n.onLoad=function(){var e=n.props,t=e.bounds,a=e.onLoad;n.setState({loaded:!0}),!S()(t)&&t.bbox&&n.fitBounds(),a({map:n.map,mapContainer:n.mapContainer})},n.onViewportChange=function(e,t){var a=n.props.onViewportChange;n.setState({viewport:e}),a(e)},n.onResize=function(e){var t=n.props.onViewportChange,a=L({},n.state.viewport,{},e);n.setState({viewport:a}),t(a)},n.onMoveEnd=function(){var e=n.props.onViewportChange,t=n.state.viewport;if(n.map){var a=n.map.getBearing(),o=n.map.getPitch(),r=n.map.getZoom(),i=n.map.getCenter(),c=i.lng,s=L({},t,{bearing:a,pitch:o,zoom:r,latitude:i.lat,longitude:c});n.setState({viewport:s}),e(s)}},n.fitBounds=function(){var e=n.state.viewport,t=n.props,a=t.bounds,o=t.onViewportChange,r=a.bbox,i=a.options,c=L({width:n.mapContainer.offsetWidth,height:n.mapContainer.offsetHeight},e),s=new z.a(c).fitBounds([[r[0],r[1]],[r[2],r[3]]],i),l=s.longitude,p=s.latitude,d=s.zoom,u=L({},n.state.viewport,{longitude:l,latitude:p,zoom:d,transitionDuration:2500,transitionInterruption:M.b.UPDATE});n.setState({flying:!0,viewport:u}),o(u),setTimeout(function(){n.setState({flying:!1})},2500)},n}return Object(j.a)(t,e),Object(w.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.viewport,n=e.bounds,a=this.props,o=a.viewport,r=a.bounds,i=this.state.viewport;x()(o,t)||this.setState({viewport:L({},i,{},o)}),S()(r)||x()(r,n)||this.fitBounds()}},{key:"render",value:function(){var e=this,t=this.props,n=t.customClass,a=t.children,r=(t.getCursor,t.dragPan),i=t.dragRotate,s=t.scrollZoom,l=t.touchZoom,p=t.touchRotate,d=t.doubleClickZoom,u=Object(h.a)(t,["customClass","children","getCursor","dragPan","dragRotate","scrollZoom","touchZoom","touchRotate","doubleClickZoom"]),m=this.state,g=m.viewport,f=m.loaded,y=m.flying;return o.a.createElement("div",{ref:function(t){e.mapContainer=t},className:D()(Object(c.a)({"c-map":!0},n,!!n))},o.a.createElement(M.c,Object.assign({ref:function(t){e.map=t&&t.getMap()}},u,g,{width:"100%",height:"100%",dragPan:!y&&r,dragRotate:!y&&i,scrollZoom:!y&&s,touchZoom:!y&&l,touchRotate:!y&&p,doubleClickZoom:!y&&d,onViewportChange:this.onViewportChange,onResize:this.onResize,onLoad:this.onLoad,transitionInterpolator:new M.a,transitionEasing:I.a}),f&&!!this.map&&"function"===typeof a&&a(this.map)))}}]),t}(a.Component);Y.defaultProps={children:null,customClass:null,viewport:T,bounds:{},dragPan:!0,dragRotate:!0,onViewportChange:function(){},onLoad:function(){},getCursor:function(e){var t=e.isHovering,n=e.isDragging;return t?"pointer":n?"grabbing":"grab"}};var R=Y,q=(n(311),function(e){function t(){return Object(v.a)(this,t),Object(O.a)(this,Object(C.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.children;return o.a.createElement("div",{className:"c-sidebar"},o.a.createElement("div",{className:"sidebar--scroll"},e))}}]),t}(o.a.Component)),Z=n(169),V=n.n(Z),B=(n(317),n(318),n(118)),N=n(124),_=n(46),A=[{id:"gain",name:"Tree cover gain",config:{type:"raster",source:{type:"raster",tiles:["https://earthengine.google.org/static/hansen_2013/gain_alpha/{z}/{x}/{y}.png"],minzoom:3,maxzoom:12}},legendConfig:{type:"basic",items:[{name:"Tree cover gain",color:"#6D6DE5"}]}},{id:"loss",name:"Tree cover loss",config:{type:"raster",source:{type:"raster",tiles:["https://storage.googleapis.com/wri-public/Hansen_16/tiles/hansen_world/v1/tc30/{z}/{x}/{y}.png"],minzoom:3,maxzoom:12}},legendConfig:{enabled:!0},decodeConfig:[{default:"2001-01-01",key:"startDate",required:!0},{default:"2018-12-31",key:"endDate",required:!0}],timelineConfig:{step:1,speed:250,interval:"years",dateFormat:"YYYY",trimEndDate:"2018-12-31",maxDate:"2018-12-31",minDate:"2001-01-01",canPlay:!0,railStyle:{background:"#DDD"},trackStyle:[{background:"#dc6c9a"},{background:"#982d5f"}]},decodeFunction:"\n      // values for creating power scale, domain (input), and range (output)\n      float domainMin = 0.;\n      float domainMax = 255.;\n      float rangeMin = 0.;\n      float rangeMax = 255.;\n\n      float exponent = zoom < 13. ? 0.3 + (zoom - 3.) / 20. : 1.;\n      float intensity = color.r * 255.;\n\n      // get the min, max, and current values on the power scale\n      float minPow = pow(domainMin, exponent - domainMin);\n      float maxPow = pow(domainMax, exponent);\n      float currentPow = pow(intensity, exponent);\n\n      // get intensity value mapped to range\n      float scaleIntensity = ((currentPow - minPow) / (maxPow - minPow) * (rangeMax - rangeMin)) + rangeMin;\n      // a value between 0 and 255\n      alpha = zoom < 13. ? scaleIntensity / 255. : color.g;\n\n      float year = 2000.0 + (color.b * 255.);\n      // map to years\n      if (year >= startYear && year <= endYear && year >= 2001.) {\n        color.r = 220. / 255.;\n        color.g = (72. - zoom + 102. - 3. * scaleIntensity / zoom) / 255.;\n        color.b = (33. - zoom + 153. - intensity / zoom) / 255.;\n      } else {\n        alpha = 0.;\n      }\n    "},{id:"protected-areas",name:"Protected areas",config:{type:"vector",source:{type:"vector",provider:{type:"carto",options:{account:"wri-01",layers:[{options:{cartocss:"#wdpa_protected_areas {  polygon-opacity: 1.0; polygon-fill: #704489 }",cartocss_version:"2.3.0",sql:"SELECT * FROM wdpa_protected_areas"},type:"mapnik"}]}}},render:{layers:[{type:"fill","source-layer":"layer0",paint:{"fill-color":"#5ca2d1","fill-opacity":1}},{type:"line","source-layer":"layer0",paint:{"line-color":"#000000","line-opacity":.1}}]}},paramsConfig:[],legendConfig:{type:"basic",items:[{name:"Protected areas",color:"#5ca2d1"}]}},{id:"mongabay-stories",name:"Mongabay stories",config:{type:"geojson",source:{type:"geojson",data:"https://wri-01.carto.com/api/v2/sql?q=SELECT%20*%20FROM%20mongabay&format=geojson"},render:{metadata:{position:"top"},layers:[{type:"circle",paint:{"circle-color":["interpolate",["exponential",.5],["zoom"],3,"#e2714b",6,"#eee695"],"circle-stroke-width":1},metadata:{position:"top"}}]}},paramsConfig:[],legendConfig:{type:"basic",items:[{name:"Mongabay stories",color:"#FFCC00"}]}}];n(361);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(n,!0).forEach(function(t){Object(c.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var G=function(){var e=Object(a.useState)(A),t=Object(s.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(JSON.stringify(A,null,2)),l=Object(s.a)(i,2),d=l[0],u=l[1],m=Object(a.useState)({}),g=Object(s.a)(m,2),f=g[0],y=g[1],h=n.map(function(e){var t=e.id,n=e.paramsConfig,a=e.sqlConfig,o=e.decodeConfig,r=e.timelineConfig,i=f[t]||{},c=!!n&&b(n,i.params),s=!!a&&b(a,i.sqlParams),l=!!o&&b(o,W({},r,{},i.decodeParams)),p=!!r&&W({},r,{},b(n,i.params),{},b(o,i.decodeParams));return W({id:t,slug:t,dataset:t,layers:[W({active:!0},e,{},i,{params:c,sqlParams:s,decodeParams:l,timelineParams:p})]},i)}),v=function(e,t){y(W({},f,Object(c.a)({},e.id,W({},f[e.id],{visibility:t}))))},w=function(e,t){y(W({},f,Object(c.a)({},e.id,W({},f[e.id],{opacity:t}))))},O=function(e,t){var n=t.id,a=t.decodeConfig;y(W({},f,Object(c.a)({},n,W({},f[n],{},a&&{decodeParams:{startDate:e[0],endDate:e[1],trimEndDate:e[2]}},{},!a&&{params:{startDate:e[0],endDate:e[1]}}))))};return o.a.createElement("div",{className:"c-app"},o.a.createElement(_.Icons,null),o.a.createElement("div",{className:"c-main"},o.a.createElement(q,null,o.a.createElement(V.a,{mode:"json",theme:"github",value:d,onChange:function(e){u(e);try{var t=JSON.parse(e);r(t)}catch(n){}},tabSize:2,width:"100%",height:"100%",wrapEnabled:!0,showPrintMargin:!1,editorProps:{$blockScrolling:!0},debounceChangePeriod:500})),o.a.createElement("div",{className:"c-map-container"},o.a.createElement(R,{mapboxApiAccessToken:"pk.eyJ1IjoibGF5ZXItbWFuYWdlciIsImEiOiJjazA2dTJnMG0zc3lwM251dGM0aXhiYTVxIn0.AaoErQTRezfQshqnEKIg8A",minZoom:2},function(e){return o.a.createElement(B.LayerManager,{map:e,plugin:N.a,providers:{"carto-sql-points":function(e,t,n,a){var o=e.source.provider;Object(N.b)("get",o.url,o.options,e).then(function(e){return n(W({},t,{source:W({},p()(t.source,"provider"),{data:{type:"FeatureCollection",features:e.rows.map(function(e){return{type:"Feature",properties:e,geometry:{type:"Point",coordinates:[e.lon,e.lat]}}})}})}))}).catch(function(e){a(e)})}}},n.map(function(e){var t=e.id,n=e.paramsConfig,a=e.sqlConfig,r=e.decodeConfig,i=e.timelineConfig,c=e.decodeFunction,s=f[t]||{},l=W({},e,{},e.config,{},s,{},!!n&&{params:b(n,W({},s.params))},{},!!a&&{sqlParams:b(a,W({},s.sqlParams))},{},!!r&&{decodeParams:b(r,W({},i,{},s.decodeParams)),decodeFunction:c});return o.a.createElement(B.Layer,Object.assign({key:e.id},l))}))}),o.a.createElement("div",{className:"c-legend"},o.a.createElement(_.Legend,{maxHeight:"65vh",collapsable:!1,sortable:!1,onChangeOrder:function(e){console.log("onChangeOrder",e)}},h.map(function(e,t){return o.a.createElement(_.LegendListItem,{index:t,key:e.slug,layerGroup:e,toolbar:o.a.createElement(_.LegendItemToolbar,null,o.a.createElement(_.LegendItemButtonOpacity,{trackStyle:{background:"#FFCC00"},handleStyle:{background:"#FFCC00"}}),o.a.createElement(_.LegendItemButtonVisibility,null)),onChangeVisibility:v,onChangeOpacity:w},o.a.createElement(_.LegendItemTypes,null),o.a.createElement(_.LegendItemTimeStep,{defaultStyles:{handleStyle:{backgroundColor:"white",borderRadius:"50%",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.29)",border:"0px",zIndex:2},railStyle:{backgroundColor:"#d6d6d9"},dotStyle:{visibility:"hidden",border:"0px"}},handleChange:O}))}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(362);i.a.render(o.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[214,1,2]]]);
//# sourceMappingURL=main.ccd26913.chunk.js.map